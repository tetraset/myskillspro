!function(t,e){"function"==typeof define&&define.amd?define([],e.bind(this,t,t.videojs)):"undefined"!=typeof module&&module.exports?module.exports=e(t,t.videojs):e(t,t.videojs)}(window,function(t,e){"use strict";var n=function(n){var o=this,r=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},a=function(t){var e={};return t&&"[object Function]"===e.toString.call(t)},i=function(t){return!!t},u=function(t,e){var n={};return e.forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n},f=function(t,n){return n=n||1,e.formatTime(t)+"."+Math.floor(t%1*Math.pow(10,n))},c=function(t,e){var n=Math.pow(10,e);return Math.floor(t*n)/n},l=function(t){if(void 0!==t){if(r(t))return t;if(/^([+\-])?([\d\.]+)$/i.test(t))return parseFloat(t);var e=/^([+\-])?((([\d]+)(h|:(?=.*:)))?(([\d]+)(m|:|$))?)?(([\d\.]+)s?)?$/i.exec(t);if(!e)return null;var n={match:e[0],sign:e[1],hours:e[4]||0,mins:e[7]||0,secs:e[10]||0},o="-"==n.sign?-1:1,a=60*parseFloat(n.hours)*60+60*parseFloat(n.mins)+parseFloat(n.secs);return r(a)?o*a:null}},p={},s={start:{default:0,validate:function(t){return!1===t?t:r(t)&&t>=0?t:0}},end:{default:!1,validate:function(t){if(!1===t)return t;if(r(t)){var e=o.duration();if(void 0===e||0===e){if(t>=0)return t}else{if(t>=0&&t<=e)return t;if(t>e)return e}}return!1}},enabled:{default:!1,validate:i},loopIfBeforeStart:{default:!0,validate:i},loopIfAfterEnd:{default:!0,validate:i},pauseBeforeLooping:{default:!1,validate:i},pauseAfterLooping:{default:!1,validate:i}},d={onLoopCallBack:{default:void 0,check:a},onOptionsChange:{default:void 0,check:a}},g=Object.keys(s),h=Object.keys(d),L=function(){n=n||{};var t=function(t){return function(e){void 0===n[e]&&(n[e]=t[e].default)}};g.forEach(t(s)),h.forEach(t(d))},v=function(){h.forEach(function(t){d[t].check(n[t])&&(J[t]=n[t])})},m=function(){return g.forEach(function(t){p[t]=s[t].validate(p[t])}),J},y=function(){return b(n,!0)},b=function(t,e){return g.forEach(function(n){(e||void 0!==t[n])&&(p[n]=t[n])}),m(),J},U=!1,E=function(t){return t?p.pauseBeforeLooping&&!1===U?(o.pause(),U=!0):(U=!1,o.currentTime(p.start),p.pauseAfterLooping&&o.pause(),d.onLoopCallBack.check(J.onLoopCallBack)&&J.onLoopCallBack(J,o)):(U=!1,o.currentTime(p.start)),J},A=function(t){return function(e){return!1===e?p[t]=!1:(void 0!==e&&(e=l(e)),null!==e&&(e=void 0===e?o.currentTime():e,p[t]=e)),J}},B=function(t){return function(e){return e=l(e),r(e)&&(p[t]+=e),J}},O=function(){return p.enabled=!0,J},k=function(t){return function(){return p[t]=!p[t],J}},S=function(e){if(!e.match(/^https?:\/\//)&&t&&t.document){var n=t.document.createElement("div");n.innerHTML='<a href="'+e+'">x</a>',e=n.firstChild.href}return e},T=function(t){(t=t||{}).decimalPlaces=Math.floor(t.decimalPlaces)||3;var e=!1!==p.start?parseFloat(p.start):0,n="#t="+c(e,t.decimalPlaces);if(!1!==p.end){var o=parseFloat(p.end);n+=","+c(o,t.decimalPlaces)}return n},F=function(t){t=t||{};var e=o.currentSrc();return e.src&&(e=e.src),e+T(t)},P=function(t){if("string"==typeof t&&(t=e.parseUrl(t)),t.hash){var n=/^(#?t=)?([^,]*)(,(.*))?$/,o=t.hash.replace(n,"$2"),a=t.hash.replace(n,"$4");o=l(o),a=l(a),r(o)&&(p.start=parseFloat(o)),r(a)&&(p.end=parseFloat(a))}return J},x=function(t){var e=t;return"string"==typeof t?e=[t]:void 0!==t&&Array.isArray(t)||(e=null!==t&&"object"==typeof t?Object.keys(t):Object.keys(s)),u(p,e)},j=function(t,e){var n=!e;return e=e||{},g.forEach(function(t){e[t]=!!e[t]||n}),function(){var n=arguments,r=x(),a=t.apply(null,n),i={changed:e,oldOpts:r,newOpts:x()};return J.onOptionsChange&&J.onOptionsChange(i,J,o),G(e),a}},C=!1,K=function(){var t,e,n;if(m(),t=o.currentTime(),e=$(),(n=w())>e){if(C=!0,t<n-.5&&t>e&&(t-e<1||p.loopIfAfterEnd||p.loopIfBeforeStart))return!0}else{if(C=!1,t<n-.5&&p.loopIfBeforeStart)return!0;if(t>=e&&(t-e<1||p.loopIfAfterEnd))return!0}return!1},w=function(){return!1===p.start?0:p.start},$=function(){return!1===p.end?o.duration():p.end},I=!1,M=r(n.minLoopLength)&&n.minLoopLength>0?n.minLoopLength:200,R=function(t){!I&&p.enabled&&!o.paused()&&K()&&(I=!0,setTimeout(function(){I=!1},M),E(!0))},N={},D=[{name:"start",optionsUsed:["start"],leftclick:function(t,e){e.shiftKey?t.adjustStart(-.5):t.setStart()},rightclick:function(t,e){e.shiftKey?t.adjustStart(.5):t.goToStart()},defaultText:"Start",textFunction:function(t){return f(t.start)}},{name:"end",optionsUsed:["end"],leftclick:function(t,e){e.shiftKey?t.adjustEnd(-.5):e.ctrlKey?t.adjustEnd(-.05):t.setEnd()},rightclick:function(t,e){e.shiftKey?t.adjustEnd(.5):e.ctrlKey?t.adjustEnd(.05):t.goToEnd()},defaultText:"End",textFunction:function(t){return f(t.end)}},{name:"enabled",optionsUsed:["enabled","pauseAfterLooping","pauseBeforeLooping"],leftclick:function(e,n){t&&t.prompt?n.ctrlKey?e.applyUrl(H("Set new URL",e.getAbsoluteUrl())):n.altKey?e.applyUrl(H("Set new URL",e.getUrl())):n.shiftKey?e.applyUrlFragment(H("Set new URL fragment",e.getUrlFragment())):e.toggle():e.toggle()},rightclick:function(e,n){var o;t&&t.prompt&&(n.ctrlKey?o=e.getAbsoluteUrl():n.altKey?o=e.getUrl():n.shiftKey&&(o=e.getUrlFragment())),o?q(o):e.cyclePauseOnLooping()},defaultText:"Loop",textFunction:function(t){return t.enabled?t.pauseBeforeLooping&&t.pauseAfterLooping?"PAUSE LOOP PAUSE":t.pauseAfterLooping?"LOOP& PAUSE":t.pauseBeforeLooping?"PAUSE &LOOP":"LOOP ON":"Loop off"}}],q=function(e){t&&t.prompt&&t.prompt("Copy to clipboard: Ctrl+C, Enter",e)},H=function(e,n){return!(!t||!t.prompt)&&t.prompt(e,n)},V=function(t,e){var n=function(t,n){return function(o){(void 0===n||o.which&&o.which==n)&&(t(e.abLoopPlugin,o),this.updateText())}},o=e.controlBar.addChild("Button");return t.leftclick&&o.on("click",n(t.leftclick)),t.rightclick&&(o.el().onmousedown=n(t.rightclick,3).bind(o),o.on("contextmenu",function(t){return t.preventDefault&&t.preventDefault(),t.preventDefault&&t.stopPropagation(),!1})),o.updateText=function(t,e){return function(){var n=e(p)||t;this.el().textContent=n}}(t.defaultText,t.textFunction),o.optionsUsed=t.optionsUsed,o.addClass("abLoopButton"),o.addClass(t.name),o.updateText(),o},z=function(t){t.forEach(function(t){void 0===N[t.name]&&(N[t.name]=V(t,o))})},G=function(t){for(var e in N){var n=N[e];(!n.optionsUsed||n.optionsUsed.reduce(function(e,n){return e||t[n]},!1))&&n.updateText()}},J={validateOptions:j(m),resetToInitialOptions:j(y),setOptions:j(b),getOptions:x,goToStart:E,goToEnd:function(){return U=!1,o.currentTime(p.end),J},setStart:j(A("start"),{start:!0}),setEnd:j(A("end"),{end:!0}),adjustStart:j(B("start"),{start:!0}),adjustEnd:j(B("end"),{end:!0}),enable:j(O,{enabled:!0}),disable:j(function(){return p.enabled=!1,J},{enabled:!0}),toggle:j(k("enabled"),{enabled:!0}),togglePauseAfterLooping:j(k("pauseAfterLooping"),{pauseAfterLooping:!0}),togglePauseBeforeLooping:j(k("pauseBeforeLooping"),{pauseBeforeLooping:!0}),cyclePauseOnLooping:j(function(){var t=p.pauseAfterLooping,e=p.pauseBeforeLooping;return b(t||e?t&&!e?{pauseAfterLooping:!1,pauseBeforeLooping:!0}:!t&&e?{pauseAfterLooping:!0,pauseBeforeLooping:!0}:{pauseAfterLooping:!1,pauseBeforeLooping:!1}:{pauseAfterLooping:!0,pauseBeforeLooping:!1}),J},{pauseBeforeLooping:!0,pauseAfterLooping:!0}),player:o,version:"0.4.5",getAbsoluteUrl:function(t){return S(F(t))},getUrl:F,getUrlFragment:T,applyUrl:j(function(t){var e=t.replace(/^(.*?)(#.*)?$/,"$1"),n=t.replace(/^(.*?)(#.*)?$/,"$2"),r=o.currentSrc();return r!=e&&r!=t&&t!=n&&o.src(e),n&&P(n),J},{start:!0,end:!0}),applyUrlFragment:j(P,{start:!0,end:!0}),loopRequired:K,playLoop:j(function(){return m(),E(!1),O(),o.play(),J})};return L(),v(),j(y)(),o.ready(function(){0!=n.createButtons&&z(D),o.on("ended",function(){C&&p.enabled&&!o.loop()&&o.play()})}),o.abLoopPlugin=J,o.on("timeupdate",R),J.loaded=!0,J};n.loaded=!1,n.VERSION="0.4.5",e.plugin("abLoopPlugin",n)});